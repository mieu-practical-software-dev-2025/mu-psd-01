<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>みんなの献立アドバイザー</title>
  <!-- Vue.jsライブラリをCDNから読み込み -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <!-- Bootstrap (CSSフレームワーク) をCDNから読み込み -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
  <style>
    /* Vue.jsが初期化されるまで、v-cloak属性を持つ要素を非表示にする */
    [v-cloak] {
      display: none;
    }
    /* --- カスタムスタイル --- */
    body {
      background-color: #f8f9fa; /* 少し明るい背景色 */
    }
    #app {
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    .card {
      transition: transform 0.2s ease-in-out;
    }
    .card:hover {
      transform: translateY(-5px); /* カードにマウスを乗せると少し浮き上がる */
    }
    .plan-title {
      border-bottom: 2px solid #0d6efd; /* プランタイトルの下線 */
      padding-bottom: 0.5rem;
      color: #0d6efd;
    }
  </style>
</head>
<body>
  <!-- Vueアプリケーションがマウントされるルート要素。このdiv内でVueの機能が有効になる -->
  <div id="app" class="container my-5 p-4 p-md-5" v-cloak>
    <h2 class="text-center text-primary mb-5">みんなの献立アドバイザー</h2>

    <!-- 入力フォームセクション -->

    <!-- 食材入力 -->
    <div class="mb-3">
      <label for="ingredients" class="form-label">食材（カンマ区切り）:</label>
      <!-- v-model="ingredientsText": Vueインスタンスの`ingredientsText`データと双方向バインディング -->
      <textarea v-model="ingredientsText" id="ingredients" class="form-control" rows="3"
        placeholder="例: 鶏肉, 玉ねぎ, じゃがいも"></textarea>
    </div>

    <!-- 予算入力 -->
    <div class="mb-3">
      <label for="budget" class="form-label">予算（円・任意）:</label>
      <!-- v-model="budget": Vueインスタンスの`budget`データと双方向バインディング -->
      <input v-model.number="budget" type="number" id="budget" class="form-control" placeholder="500" min="0">
    </div>

    <!-- 嗜好・条件入力 -->
    <div class="mb-3">
      <label for="preference" class="form-label">嗜好・条件（任意）:</label>
      <!-- v-model="preference": Vueインスタンスの`preference`データと双方向バインディング -->
      <input v-model="preference" id="preference" type="text" class="form-control"
             placeholder="例: カロリー控えめ、中華、和食、糖質制限など">
    </div>

    <!-- 実行ボタン -->
    <div class="mb-3">
      <!-- @click="generateMenu": クリック時にVueインスタンスの`generateMenu`メソッドを実行 -->
      <!-- :disabled="loading": `loading`データがtrueの間、ボタンを無効化する -->
      <button class="btn btn-primary btn-lg w-100" @click="generateMenu" :disabled="loading">
        <span v-if="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <span v-if="loading"> 作成中...</span>
        <span v-else>献立を作成</span>
      </button>
    </div>

    <!-- 結果表示セクション -->

    <!-- v-if="error": `error`データに値がある場合のみ、この要素を表示 -->
    <div v-if="error" class="alert alert-danger">{{ error }}</div>

    <!-- v-if="menu": `menu`データに値がある場合のみ、この要素（献立全体）を表示 -->
    <div v-if="menu" class="mt-4">
      <h3>{{ menu.menu_title }}</h3>

      <!-- 今ある食材だけで作る献立プラン -->
      <!-- 'menu-plan'はmain.jsで定義したカスタムコンポーネント -->
      <!-- :title, :plan はコンポーネントに渡すプロパティ(props) -->
      <menu-plan
        title="① 今ある食材だけで作る献立"
        :plan="menu.plan_without_budget">
      </menu-plan>

      <!-- 予算を使った献立プラン -->
      <menu-plan
        title="② 予算を使った献立"
        :plan="menu.plan_with_budget">
      </menu-plan>

      <!-- 調味料リスト -->
      <div v-if="menu && menu.seasonings_used && menu.seasonings_used.length > 0" class="card mt-4">
        <div class="card-header">
          <h5 class="mb-0">使用する調味料リスト（買い忘れチェック！）</h5>
        </div>
        <ul class="list-group list-group-flush">
          <li v-for="item in menu.seasonings_used" :key="item" class="list-group-item">
            {{ item }}
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- 外部JavaScriptファイルを読み込み。Vueのロジックが記述されている -->
  <!-- defer属性により、HTMLのパース完了後にスクリプトが実行される -->
  <script src="/main.js" defer></script>
</body>
</html>